<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafios Ambientais</title>
    <link rel="stylesheet" href="../css/tarefas.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <header>
        <div class="header-title">
            <h1>
                <svg
                    class="leaf-icon"
                    width="30"
                    height="30"
                    viewBox="0 0 24 24"
                    fill="white"
                >
                    <path
                        d="M17,8C8,10 5.9,16.17 3.82,21.34L5.71,22L6.66,19.7C7.14,19.87 7.64,20 8,20C19,20 22,3 22,3C21,5 14,5.25 9,6.25C4,7.25 2,11.5 2,13.5C2,15.5 3.75,17.25 3.75,17.25C7,8 17,8 17,8Z"
                    />
                </svg>
                <strong>Cycloroot</strong>
            </h1>
        <nav>
            <a href="../html/pagina.html" class="active">Inicio</a>
            <a href="../html/Calendário.html" class="active">Calendário</a>
            <a href="../html/doações.html" class="active">doações</a>
            <a href="../html/faleconosco.html" class="active">faleconosco</a>
            <a href="../html/Instruções.html" class="active">Instruções</a>
            <a href="../html/Reciclagem.html" class="active">Reciclagem</a>
            <a href="../html/Relatório.html" class="active">Relatório</a>
        </nav>
    
             
    </header>

    <div class="container">
        <div class="period-selector">
            <button id="ideasBtn" class="nav-btn">Ideias Ambientais</button>
        </nav>
            <button class="period-btn active" data-period="daily">Diário</button>
            <button class="period-btn" data-period="weekly">Semanal</button>
            <button class="period-btn" data-period="monthly">Mensal</button>
            
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div id="dailyProgress" class="progress daily">
                    <div class="progress-label">0%</div>
                    <div class="progress-fill"></div>
                </div>
                <div id="weeklyProgress" class="progress weekly" style="display:none;">
                    <div class="progress-label">0%</div>
                    <div class="progress-fill"></div>
                </div>
                <div id="monthlyProgress" class="progress monthly" style="display:none;">
                    <div class="progress-label">0%</div>
                    <div class="progress-fill"></div>
                </div>
            </div>
        </div>

        <main>
            <section id="taskList" class="task-list">
                <!-- Tarefas serão geradas dinamicamente -->
            </section>

            <div id="proofModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Comprove sua Missão Ambiental</h2>
                    <div class="modal-upload">
                        <input type="file" id="proofUpload" accept="image/*" capture="camera">
                        <label for="proofUpload" class="upload-label">
                            <i class="bi bi-camera"></i>
                            <span>Escolher Imagem</span>
                        </label>
                    </div>
                    <button id="submitProof">Enviar Comprovação</button>
                </div>
            </div>

            <div id="ideasModal" class="modal">
                <div class="modal-content">
                    <span class="close-ideas">&times;</span>
                    <h2>Ideias de Ações Ambientais</h2>
                    <div id="environmentalIdeas"></div>
                </div>
            </div>
            <div id="ideaDetailsModal" class="modal">
                <div class="modal-content idea-details-content">
                    <span class="close-idea-details">&times;</span>
                    <div id="ideaDetailsContent"></div>
                </div>
            </div>
        </main>
    </div>

    <footer class="main-footer">
        <div class="footer-content">
            <p>&copy; 2023 Eco Missões. Juntos pela Sustentabilidade!</p>
            <div class="social-links">
                <a href="#" class="social-icon"><i class="bi bi-facebook"></i></a>
                <a href="#" class="social-icon"><i class="bi bi-twitter"></i></a>
                <a href="#" class="social-icon"><i class="bi bi-instagram"></i></a>
            </div>
        </div>
    </footer>

    <script>

        document.addEventListener('DOMContentLoaded', () => {
            const environmentalTasks = [
                {
                    id: 1,
                    title: "Separar Resíduos Recicláveis",
                    description: "Aprenda a separar corretamente diferentes tipos de resíduos.",
                    icon: "bi-recycle",
                    category: "Reciclagem"
                },
                {
                    id: 2,
                    title: "Economizar Água no Banho",
                    description: "Reduza o tempo do banho e use chuveiro econômico.",
                    icon: "bi-droplet",
                    category: "Conservação"
                },
                {
                    id: 3,
                    title: "Transporte Sustentável",
                    description: "Use transporte público, bicicleta ou caminhe.",
                    icon: "bi-bicycle",
                    category: "Mobilidade"
                },
                {
                    id: 4,
                    title: "Plantar uma Árvore/Muda",
                    description: "Contribua para o reflorestamento em sua comunidade.",
                    icon: "bi-tree",
                    category: "Reflorestamento"
                },
                {
                    id: 5,
                    title: "Consumo Consciente de Energia",
                    description: "Desligue aparelhos quando não estiver usando.",
                    icon: "bi-lightning",
                    category: "Energia"
                },
                {
                    id: 6,
                    title: "Compostagem Doméstica",
                    description: "Transforme resíduos orgânicos em adubo.",
                    icon: "bi-flower1",
                    category: "Sustentabilidade"
                }
            ];
        
            const environmentalIdeas = [
            {
                title: "Compostagem em Casa",
                description: "Transforme resíduos orgânicos em adubo nutritivo para plantas.",
                icon: "bi-recycle",
                fullDetails: `
                    <h3>Compostagem Doméstica: Transformando Resíduos em Recurso</h3>
                    <p>A compostagem é uma técnica simples e ecológica para reciclar resíduos orgânicos.</p>
                    
                    <h4>O que você vai precisar:</h4>
                    <ul>
                        <li>Um recipiente com tampa</li>
                        <li>Restos de frutas e verduras</li>
                        <li>Folhas secas</li>
                        <li>Serragem ou papel picado</li>
                    </ul>
                    
                    <h4>Passos para iniciar:</h4>
                    <ol>
                        <li>Escolha um local ventilado e protegido</li>
                        <li>Coloque uma camada de folhas secas no fundo</li>
                        <li>Adicione restos de alimentos</li>
                        <li>Cubra com folhas secas</li>
                        <li>Revire o composto semanalmente</li>
                    </ol>
                    
                    <p>Benefícios: Reduz lixo, produz adubo natural e ajuda o meio ambiente!</p>
                `
            },
            {
                title: "Horta Vertical",
                description: "Crie uma horta em vasos ou paletes suspensos em espaços pequenos.",
                icon: "bi-flower1",
                fullDetails: `
                    <h3>Horta Vertical: Cultivo Sustentável em Espaços Limitados</h3>
                    <p>Transforme sua varanda ou parede em um jardim produtivo!</p>
                    
                    <h4>Materiais necessários:</h4>
                    <ul>
                        <li>Paletes de madeira ou suportes metálicos</li>
                        <li>Vasos ou sacos de plantio</li>
                        <li>Terra para plantas</li>
                        <li>Mudas de ervas e hortaliças</li>
                    </ul>
                    
                    <h4>Dicas de plantio:</h4>
                    <ol>
                        <li>Escolha plantas adequadas para vasos</li>
                        <li>Use terra rica em nutrientes</li>
                        <li>Garanta boa iluminação</li>
                        <li>Faça irrigação regular</li>
                    </ol>
                    
                    <p>Vantagens: Economiza espaço, produz alimentos frescos e embeleza o ambiente!</p>
                `
            },
            {
                title: "Redução de Plástico",
                description: "Use alternativas sustentáveis para reduzir o consumo de plástico descartável.",
                icon: "bi-bag-dash",
                fullDetails: `
                    <h3>Redução de Plástico: Escolhas Conscientes no Dia a Dia</h3>
                    <p>Pequenas ações podem fazer grande diferença na redução de resíduos plásticos.</p>
                    
                    <h4>Alternativas sustentáveis:</h4>
                    <ul>
                        <li>Sacolas reutilizáveis de tecido</li>
                        <li>Garrafas de água reutilizáveis</li>
                        <li>Canudos de metal ou bambu</li>
                        <li>Embalagens reutilizáveis para alimentos</li>
                    </ul>
                    
                    <h4>Estratégias para reduzir:</h4>
                    <ol>
                        <li>Compre a granel quando possível</li>
                        <li>Recuse itens plásticos desnecessários</li>
                        <li>Prefira produtos com menos embalagens</li>
                        <li>Recicle corretamente</li>
                    </ol>
                    
                    <p>Impacto: Menos poluição, preservação de ecossistemas e redução de resíduos!</p>
                `
            },
            {
                title: "Economia de Água",
                description: "Técnicas para reduzir o consumo de água em casa.",
                icon: "bi-droplet",
                fullDetails: `
                    <h3>Economia de Água: Cada Gota Conta!</h3>
                    <p>Descubra maneiras simples de economizar água no dia a dia.</p>
                    
                    <h4>Dispositivos de economia:</h4>
                    <ul>
                        <li>Torneiras com sensor</li>
                        <li>Chuveiros com limitador de vazão</li>
                        <li>Válvulas de descarga econômicas</li>
                        <li>Coletores de água da chuva</li>
                    </ul>
                    
                    <h4>Práticas sustentáveis:</h4>
                    <ol>
                        <li>Reutilize água da máquina de lavar</li>
                        <li>Conserte vazamentos imediatamente</li>
                        <li>Tome banhos mais curtos</li>
                        <li>Feche a torneira ao escovar os dentes</li>
                    </ol>
                    
                    <p>Resultado: Economia financeira e preservação de recursos hídricos!</p>
                `
            },
            {
                title: "Mutirão de Limpeza",
                description: "Organize ou participe de ações de limpeza em espaços públicos.",
                icon: "bi-people",
                fullDetails: `
                    <h3>Mutirão de Limpeza: Comunidade em Ação</h3>
                    <p>Unite forças para limpar e preservar espaços públicos!</p>
                    
                    <h4>Como organizar um mutirão:</h4>
                    <ul>
                        <li>Escolha um local (parque, praia, rua)</li>
                        <li>Convide amigos, família e vizinhos</li>
                        <li>Providencie luvas e sacos de lixo</li>
                        <li>Divulgue nas redes sociais</li>
                    </ul>
                    
                    <h4>Dicas de segurança:</h4>
                    <ol>
                        <li>Use equipamentos de proteção</li>
                        <li>Separe o lixo para reciclagem</li>
                        <li>Documente a ação</li>
                        <li>Compartilhe para inspirar outros</li>
                    </ol>
                    
                    <p>Impacto: Comunidade unida, ambiente mais limpo e conscientização!</p>
                `
            },
            {
                title: "Energia Solar",
                description: "Explore alternativas de energia renovável para sua residência.",
                icon: "bi-sun",
                fullDetails: `
                    <h3>Energia Solar: Sustentabilidade em Sua Casa</h3>
                    <p>Descubra como implementar energia solar de forma acessível.</p>
                    
                    <h4>Opções de implementação:</h4>
                    <ul>
                        <li>Painéis solares para telhado</li>
                        <li>Aquecedores solares</li>
                        <li>Carregadores solares portáteis</li>
                        <li>Lâmpadas e dispositivos com energia solar</li>
                    </ul>
                    
                    <h4>Primeiros passos:</h4>
                    <ol>
                        <li>Faça uma auditoria energética</li>
                        <li>Consulte especialistas</li>
                        <li>Comece com dispositivos pequenos</li>
                        <li>Calcule o retorno do investimento</li>
                    </ol>
                    
                    <p>Benefícios: Economia, independência energética e redução de emissões!</p>
                `
            }
        ];

            function initTasks() {
                const taskList = document.getElementById('taskList');
                taskList.innerHTML = ''; // Clear existing tasks
                
                const completedTasks = JSON.parse(localStorage.getItem('completedTasks') || '[]');
                
                environmentalTasks.forEach(task => {
                    const taskCompletions = completedTasks.filter(ct => ct.id === task.id);
                    const dailyCompletions = taskCompletions.filter(ct => isToday(ct)).length;
                    const weeklyCompletions = taskCompletions.filter(ct => isThisWeek(ct)).length;
                    const monthlyCompletions = taskCompletions.filter(ct => isThisMonth(ct)).length;
                    
                    const taskCard = document.createElement('div');
                    taskCard.classList.add('task-card');
                    taskCard.dataset.taskId = task.id;
                    
                    taskCard.innerHTML = `
                        <div class="task-icon">
                            <i class="bi ${task.icon}"></i>
                        </div>
                        <div class="task-info">
                            <h3>${task.title}</h3>
                            <p>${task.description}</p>
                            <p class="task-category">${task.category}</p>
                            
                            <div class="task-progress-container">
                                <div class="task-progress-period">
                                    <span>Diário</span>
                                    <div class="task-progress">
                                        <div class="progress-fill" style="width: ${calculatePercentage(dailyCompletions)}%"></div>
                                        <span class="progress-text" data-period="daily">${calculatePercentage(dailyCompletions)}%</span>
                                    </div>
                                </div>
                                
                                <div class="task-progress-period">
                                    <span>Semanal</span>
                                    <div class="task-progress">
                                        <div class="progress-fill" style="width: ${calculatePercentage(weeklyCompletions)}%"></div>
                                        <span class="progress-text" data-period="weekly">${calculatePercentage(weeklyCompletions)}%</span>
                                    </div>
                                </div>
                                
                                <div class="task-progress-period">
                                    <span>Mensal</span>
                                    <div class="task-progress">
                                        <div class="progress-fill" style="width: ${calculatePercentage(monthlyCompletions)}%"></div>
                                        <span class="progress-text" data-period="monthly">${calculatePercentage(monthlyCompletions)}%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="task-actions">
                            <button class="complete-task">
                                <i class="bi bi-check-circle"></i> Completar
                            </button>
                        </div>
                    `;
        
                    const completeButton = taskCard.querySelector('.complete-task');
                    completeButton.addEventListener('click', () => handleTaskCompletion(task));
        
                    taskList.appendChild(taskCard);
                });
            }
        
            function setupProgressTracking() {
                const periodButtons = document.querySelectorAll('.period-btn');
                const progressBars = {
                    daily: document.getElementById('dailyProgress'),
                    weekly: document.getElementById('weeklyProgress'),
                    monthly: document.getElementById('monthlyProgress')
                };
        
                periodButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        periodButtons.forEach(btn => btn.classList.remove('active'));
                        Object.values(progressBars).forEach(bar => bar.style.display = 'none');
                        
                        const period = button.dataset.period;
                        button.classList.add('active');
                        progressBars[period].style.display = 'block';
        
                        updateProgress(period);
                    });
                });
        
                function updateProgress(selectedPeriod = 'daily') {
                    const completedTasks = JSON.parse(localStorage.getItem('completedTasks') || '[]');
                    
                    const periodFilters = {
                        daily: isToday,
                        weekly: isThisWeek,
                        monthly: isThisMonth
                    };
        
                    const filteredTasks = completedTasks.filter(periodFilters[selectedPeriod]);
                    const totalTasks = filteredTasks.length;
                    const percentage = Math.min((totalTasks / 6) * 100, 100);
        
                    const progressElement = progressBars[selectedPeriod];
                    const progressFill = progressElement.querySelector('.progress-fill');
                    const progressLabel = progressElement.querySelector('.progress-label');
                    
                    progressFill.style.width = `${percentage}%`;
                    progressLabel.textContent = `${Math.round(percentage)}%`;
                }
        
                updateProgress();
            }
        
            function setupProofModal() {
                const modal = document.getElementById('proofModal');
                const closeBtn = document.querySelector('.close');
                const uploadInput = document.getElementById('proofUpload');
                const submitBtn = document.getElementById('submitProof');
        
                closeBtn.onclick = () => modal.style.display = 'none';
        
                submitBtn.onclick = () => {
                    const file = uploadInput.files[0];
                    const currentTask = JSON.parse(modal.dataset.currentTask);
        
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            saveTaskCompletion(currentTask, e.target.result);
                            modal.style.display = 'none';
                            updateTaskUI(currentTask);
                        };
                        reader.readAsDataURL(file);
                    }
                };
            }
        
            function setupEnvironmentalIdeas() {
                const ideasBtn = document.getElementById('ideasBtn');
                const ideasModal = document.getElementById('ideasModal');
                const closeIdeasBtn = document.querySelector('.close-ideas');
                const environmentalIdeasContainer = document.getElementById('environmentalIdeas');
                const ideaDetailsModal = document.getElementById('ideaDetailsModal');
                const ideaDetailsContent = document.getElementById('ideaDetailsContent');
                const closeIdeaDetailsBtn = document.querySelector('.close-idea-details');
        
                function createIdeaElement(idea) {
                    const ideaElement = document.createElement('div');
                    ideaElement.classList.add('environmental-idea');
                    ideaElement.innerHTML = `
                        <div class="idea-header">
                            <i class="bi ${idea.icon} idea-icon"></i>
                            <h3>${idea.title}</h3>
                        </div>
                        <p>${idea.description}</p>
                        <button class="learn-more-btn" data-title="${idea.title}">Saiba Mais</button>
                    `;
        
                    ideaElement.addEventListener('mouseenter', () => {
                        ideaElement.classList.add('idea-hover');
                    });
        
                    ideaElement.addEventListener('mouseleave', () => {
                        ideaElement.classList.remove('idea-hover');
                    });
        
                    const learnMoreBtn = ideaElement.querySelector('.learn-more-btn');
                    learnMoreBtn.addEventListener('click', () => {
                        showIdeaDetails(idea);
                    });
        
                    return ideaElement;
                }
        
                function showIdeaDetails(idea) {
                    ideaDetailsContent.innerHTML = idea.fullDetails;
                    ideaDetailsModal.style.display = 'block';
                }
        
                ideasBtn.addEventListener('click', () => {
                    environmentalIdeasContainer.innerHTML = '';
        
                    environmentalIdeas.forEach((idea, index) => {
                        const ideaElement = createIdeaElement(idea);
                        
                        ideaElement.style.opacity = '0';
                        ideaElement.style.transform = 'translateY(20px)';
                        
                        environmentalIdeasContainer.appendChild(ideaElement);
        
                        setTimeout(() => {
                            ideaElement.style.transition = 'all 0.5s ease';
                            ideaElement.style.opacity = '1';
                            ideaElement.style.transform = 'translateY(0)';
                        }, index * 100);
                    });
        
                    ideasModal.style.display = 'block';
                });
        
                closeIdeasBtn.addEventListener('click', () => {
                    ideasModal.style.display = 'none';
                });
        
                closeIdeaDetailsBtn.addEventListener('click', () => {
                    ideaDetailsModal.style.display = 'none';
                });
        
                ideasModal.addEventListener('click', (event) => {
                    if (event.target === ideasModal) {
                        ideasModal.style.display = 'none';
                    }
                });
        
                ideaDetailsModal.addEventListener('click', (event) => {
                    if (event.target === ideaDetailsModal) {
                        ideaDetailsModal.style.display = 'none';
                    }
                });
            }
        
            function handleTaskCompletion(task) {
                const modal = document.getElementById('proofModal');
                modal.style.display = 'block';
                modal.dataset.currentTask = JSON.stringify(task);
            }
        
            function saveTaskCompletion(task, proofImage) {
                const completedTasks = JSON.parse(localStorage.getItem('completedTasks') || '[]');
                
                completedTasks.push({
                    ...task,
                    date: new Date().toISOString(),
                    proof: proofImage
                });
                
                localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
            }
        
            function updateTaskUI(task) {
                const taskCard = document.querySelector(`.task-card[data-task-id="${task.id}"]`);
                
                const completedTasks = JSON.parse(localStorage.getItem('completedTasks') || '[]')
                    .filter(ct => ct.id === task.id);
                
                const dailyCompletions = completedTasks.filter(isToday).length;
                const weeklyCompletions = completedTasks.filter(isThisWeek).length;
                const monthlyCompletions = completedTasks.filter(isThisMonth).length;
                
                updateProgressBar(taskCard, 'daily', dailyCompletions);
                updateProgressBar(taskCard, 'weekly', weeklyCompletions);
                updateProgressBar(taskCard, 'monthly', monthlyCompletions);
                
                taskCard.classList.add('completed');
            }
        
            function updateProgressBar(taskCard, period, completions, maxCompletions = 3) {
                const progressBar = taskCard.querySelector(`.task-progress-period:has(.progress-text[data-period="${period}"])`);
                if (!progressBar) return;
        
                const percentage = Math.min(Math.round((completions / maxCompletions) * 100), 100);
                
                const progressFill = progressBar.querySelector('.progress-fill');
                const progressText = progressBar.querySelector('.progress-text');
                
                progressFill.style.width = `${percentage}%`;
                progressText.textContent = `${percentage}%`;
                progressText.dataset.period = period;
            }
        
            function calculatePercentage(completions, maxCompletions = 3) {
                return Math.min(Math.round((completions / maxCompletions) * 100), 100);
            }
        
            function isToday(task) {
                const today = new Date();
                const taskDate = new Date(task.date);
                return taskDate.toDateString() === today.toDateString();
            }
        
            function isThisWeek(task) {
                const today = new Date();
                const taskDate = new Date(task.date);
                const oneWeekAgo = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7);
                return taskDate >= oneWeekAgo && taskDate <= today;
            }
        
            function isThisMonth(task) {
                const today = new Date();
                const taskDate = new Date(task.date);
                return taskDate.getMonth() === today.getMonth() && 
                       taskDate.getFullYear() === today.getFullYear();
            }
        
            initTasks();
            setupProgressTracking();
            setupProofModal();
            setupEnvironmentalIdeas();
        });


    </script>
</body>
</html>